<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>Mini App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

<h3>Mini App</h3>
<button id="sendBtn">Botga yuborish</button>
<pre id="log"></pre>

<script>
const tg = Telegram.WebApp;
tg.ready();

const log = (t) => {
  document.getElementById("log").textContent += t + "\n";
};

// 1ï¸âƒ£ ENG ISHONCHLI â€” SIGNED initData
const initData = tg.initData || "";

// 2ï¸âƒ£ Qoâ€˜shimcha (agar user koâ€˜rinsin desa)
const u = tg.initDataUnsafe?.user || {};

const fallbackString = [
  u.id || "",
  u.first_name || "",
  u.last_name || "",
  u.username || "",
  tg.platform || "",
  tg.version || "",
  Date.now()
].join("|");

// 3ï¸âƒ£ Qaysi biri yuboriladi?
// Agar initData boâ€˜lsa â€” SHUNI yuboramiz
const dataToSend = initData.length > 0 ? initData : fallbackString;

log("ðŸ“¤ Yuboriladigan STRING:");
log(dataToSend);

document.getElementById("sendBtn").onclick = () => {
  tg.sendData(dataToSend);
  tg.close();
};
</script>

</body>
</html>
