<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>Mini App JSON saqlash</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    button { padding: 10px 20px; margin: 10px 0; font-size: 16px; }
    pre { background: #f0f0f0; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>

<h3>Mini App</h3>
<button id="saveBtn">Init Data’ni saqlash</button>
<pre id="log"></pre>

<script>
const tg = Telegram.WebApp;
tg.ready();

const log = (t) => {
  document.getElementById("log").textContent += t + "\n";
};

// Mini App ochilganda data olish
const initData = tg.initData || "";
const unsafeData = tg.initDataUnsafe || {};

// JSON shaklida faylga saqlash funksiyasi
function saveJSON(data) {
  const jsonStr = JSON.stringify(data, null, 2);
  const blob = new Blob([jsonStr], { type: "application/json" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "mini_app_initdata.json";
  a.click();

  log("✅ JSON fayl yaratildi va yuklandi");
  log(jsonStr);
}

// Saqlash tugmasi
document.getElementById("saveBtn").onclick = () => {
  const dataToSave = {
    initData: initData,
    initDataUnsafe: unsafeData,
    platform: tg.platform,
    version: tg.version,
    timestamp: Date.now()
  };

  saveJSON(dataToSave);
};
</script>

</body>
</html>
